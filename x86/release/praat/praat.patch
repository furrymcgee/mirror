--- src/praat/debian/control	2020-07-09 12:11:36.014126400 -0700
+++ origsrc/praat/debian/control	2020-07-09 12:07:22.449518400 -0700
@@ -19,7 +19,7 @@
 Rules-Requires-Root: no
 
 Package: praat
-Architecture: amd64 arm64 i386 mips64el ppc64el s390x alpha kfreebsd-amd64 kfreebsd-i386 m68k powerpc powerpcspe ppc64 sparc64
+Architecture: any
 Depends: ${shlibs:Depends},
          ${misc:Depends},
          oss-compat,
--- src/praat/debian/rules	2020-07-09 13:00:55.449585600 -0700
+++ origsrc/praat/debian/rules	2020-07-09 12:59:55.232998400 -0700
@@ -17,6 +17,7 @@
 
 include /usr/share/dpkg/architecture.mk
 -include /usr/share/dpkg/buildtools.mk
+include makefiles/makefile.defs.linux.nogui
 PKG_CONFIG ?= pkg-config
 
 ifneq (,$(filter $(DEB_HOST_ARCH), i386))
@@ -51,22 +52,19 @@
 	# dpkg-shlibdeps: warning: dependency on lib??? could be avoided if "debian/praat/usr/bin/praat" were not uselessly linked against it (they use none of its symbols).
 	# warnings and useless dependencies
 	sed 's/^LIBS = /& -Wl,--as-needed /'	\
-		makefiles/makefile.defs.linux.pulse > makefile.defs
+		makefiles/makefile.defs.linux.nogui > makefile.defs
 	# Add hardening flags
 	cat debian/mk-vars-hardening >> makefile.defs
 
 %.1: $(DEBDIR)/%.dbk $(DEBDIR)/manpage.xsl
 	# Generate the man page from the DocBook source
-	xmlto -m $(DEBDIR)/manpage.xsl man $<
+	xmlto --skip-validation -m $(DEBDIR)/manpage.xsl man $<
 
 sendpraat: sys/sendpraat.c
 	# Build the sendpraat program
-	$(CC) $(shell dpkg-buildflags --get CPPFLAGS)		\
-		$(shell dpkg-buildflags --get CFLAGS)		\
-		$(shell dpkg-buildflags --get LDFLAGS)		\
+	$(CC) $(COMMON_CFLAGS)\
 		-Wl,--as-needed -std=gnu99 -DSTAND_ALONE -DUNIX	\
 		-o sendpraat sys/sendpraat.c			\
-		$(shell $(PKG_CONFIG) --cflags --libs gtk+-2.0)
 
 override_dh_auto_build: sendpraat praat.1 praat_nogui.1 sendpraat.1 praat-open-files.1
 	dh_auto_build
--- src/praat/Makefile	2020-07-09 13:29:20.000000000 -0700
+++ origsrc/praat/Makefile	2020-07-09 14:17:08.765691200 -0700
@@ -17,7 +17,6 @@
 	$(MAKE) -C external/glpk
 	$(MAKE) -C external/mp3
 	$(MAKE) -C external/flac
-	$(MAKE) -C external/portaudio
 	$(MAKE) -C external/espeak
 	$(MAKE) -C kar
 	$(MAKE) -C melder
--- src/praat/makefiles/makefile.defs.linux.nogui	2020-07-09 14:15:14.641588800 -0700
+++ origsrc/praat/makefiles/makefile.defs.linux.nogui	2020-07-09 14:12:33.309604800 -0700
@@ -9,17 +9,17 @@
 
 PKG_CONFIG ?= pkg-config
 
-COMMON_CFLAGS = -DNO_GUI -DNO_NETWORK -D_FILE_OFFSET_BITS=64 `$(PKG_CONFIG) --cflags pangocairo` -DUNIX -Dlinux -Werror=missing-prototypes -Werror=implicit -Wreturn-type -Wunused -Wunused-parameter -Wuninitialized -O3 -g1 -pthread
+COMMON_CFLAGS = -DNO_GRAPHICS -DNO_NETWORK -D_FILE_OFFSET_BITS=64 -DUNIX -Dlinux -Werror=missing-prototypes -Werror=implicit -Wreturn-type -Wunused -Wunused-parameter -Wuninitialized -O3 -g1 -pthread
 
 CFLAGS = -std=gnu99 $(COMMON_CFLAGS)
 
-CXXFLAGS = -std=c++17 $(COMMON_CFLAGS) -Wshadow
+CXXFLAGS = -std=gnu++17 $(COMMON_CFLAGS) -Wshadow
 
 LINK = $(CXX)
 
 EXECUTABLE = praat_nogui
 
-LIBS = `$(PKG_CONFIG) --libs pangocairo` -lm -lpthread
+LIBS = -lm -lpthread
 
 AR = ar
 RANLIB = ls
--- origsrc/praat/external/flac/flac_stream_decoder.c	2019-02-17 09:20:10.000000000 -0800
+++ src/praat/external/flac/flac_stream_decoder.c	2020-07-09 14:04:21.222017600 -0700
@@ -33,7 +33,7 @@
 #  include <config.h>
 #endif
 
-#if defined (_WIN32)
+#if defined (_WIN32) || defined (__CYGWIN__)
 #include <io.h> /* for _setmode() */
 #include <fcntl.h> /* for _O_BINARY */
 #endif
--- origsrc/praat/external/flac/flac_stream_encoder.c	2019-02-17 09:20:10.000000000 -0800
+++ src/praat/external/flac/flac_stream_encoder.c	2020-07-09 14:04:42.442531200 -0700
@@ -33,7 +33,7 @@
 #  include <config.h>
 #endif
 
-#if defined (_WIN32)
+#if defined (_WIN32) || defined (__CYGWIN__)
 #include <io.h> /* for _setmode() */
 #include <fcntl.h> /* for _O_BINARY */
 #endif
